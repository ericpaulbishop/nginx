server
{
	server_name          <%= (@params['server_name']).kind_of?(Array) ? (@params['server_name']).join(' ') : ( @params['server_name'] ?  @params['server_name'] : node['hostname'] )    -%>;
	listen               <%= (@params['port']).to_s                                                                                                                                     -%>;
	root                 <%= @params['root']                                                                                                                                            -%>;
	index                <%= (@params['index']).kind_of?(Array)  ? (@params['index']).join(' ') : ( @params['index'] ?  @params['index'] : 'index.html index.htm index.php index.cgi') -%>;

	<%= (@params['log_file']).nil? ? '' : @params['log_file'] -%>;
	
	<%= @params['ssl_cert'] && @params['ssl_key']   ?  "ssl                  on;" : "" -%>;
	<%= @params['ssl_cert'] && @params['ssl_key']   ?  "ssl_certificate      #{ @params['ssl_cert'] };" : "" -%>;
	<%= @params['ssl_cert'] && @params['ssl_key']   ?  "ssl_certificate_key  #{ @params['ssl_key'] };"  : "" -%>;
	                                                    error_page           
	<%- if @params['error_pages'] -%>
	<%-   (@params['error_pages']).each do | err_num, url | -%>
	<%= "error_page           " + err_num.to_s + "   " + url.to_s + ";"%>
	<%-   end -%>
	<%-   if @params['error_pages']['403'] || @params['error_pages'][403] -%>
	<%-     @params['error_pages']['403'] = @params['error_pages']['403'] || @params['error_pages'][403] -%>
	location = <%= @params['error_pages']['403'] -%>
	{
		allow all;
	}
	<%-   end -%>
	<%- end -%>



	#passenger_enabled   on;
	#passenger_base_uri  $rails_base_path; ##should be symlink to public dir of actual rails_app 


	#php
	location ~ \.php\$
        #{
        #	try_files      \$uri =404;
        #	fastcgi_pass   unix:/var/run/php-fpm.sock ;
        #	include        $NGINX_CONF_PATH/fastcgi_params;
        #}

        #perl
        #location ~ \.pl\$
        #{
        #	fastcgi_pass   unix:/var/run/fcgiwrap.socket ;
        #	include        $NGINX_CONF_PATH/fastcgi_params;
	#}

}
